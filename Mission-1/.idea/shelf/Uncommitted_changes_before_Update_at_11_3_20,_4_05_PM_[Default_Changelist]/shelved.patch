Index: server.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>'use strict' //Prevents use of undeclared variables\n// server.js\n// where your node app starts\n\n// we've started you off with Express (https://expressjs.com/)\n// but feel free to use whatever libraries or frameworks you'd like through `package.json`.\nconst express = require(\"express\")\nconst app = express()\nconst mysql = require('mysql')\nconst bodyParser = require('body-parser')\nconst https = require('https')\nconst fs = require('fs')\nconst cookieparser = require('cookie-parser')\napp.use(cookieparser())\n\nconst pool = mysql.createPool({\n    connectionLimit: 100, //this should fix the weird error event bug\n    host: 'us-cdbr-east-02.cleardb.com',\n    user: 'b0ec116f629fb6',\n    password: '1b2f0771f9e2812',\n    database: 'heroku_e362e57bba7349a',\n    supportBigNumbers: true\n});\n\n\npool.getConnection(function (err, connection) {\n    if (err) {\n        connection.release();\n        throw err;\n    }\n    let createVoterData = 'CREATE TABLE IF NOT EXISTS VoterData(ssn INT NOT NULL, voterName VARCHAR(255) NOT NULL, PRIMARY KEY(ssn, voterName));'\n    connection.query(createVoterData, function (err, results, fields) {\n        if (err) {\n            console.log(`ERROR IN CREATEVOTERDATA TABLE`)\n            return console.log(err.message)\n        }\n    })\n    let createVotes = `CREATE TABLE IF NOT EXISTS Votes(ssn INT, voterName VARCHAR(255), candidateName VARCHAR(255), FOREIGN KEY (ssn,voterName) REFERENCES voterData(ssn,voterName) ON DELETE SET NULL ON UPDATE CASCADE);`\n    connection.query(createVotes, function (err, results, fields) {\n        if (err) {\n            console.log(`ERROR IN CREATEVOTES TABLE`)\n            return console.log(err.message)\n        }\n    })\n    let sql = \"INSERT INTO VoterData(SSN, voterName) VALUES ?\";\n    let values = [\n        [111111111, 'name1'],\n        [222222222, 'name2'],\n        [333333333, 'name3'],\n        [444444444, 'name4'],\n        [555555555, 'name5'],\n        [666666666, 'name6'],\n        [777777777, 'name7'],\n        [888888888, 'name8'],\n        [999999999, 'name9'],\n        [696969696, 'name69']\n    ];\n    connection.query(sql, [values], function (err) {\n        if (err) {\n            console.log(`ERROR INSERTING VALUES INTO VOTERDATA`)\n            return console.log(err.message)\n        }\n    });\n    connection.release();\n});\n\nfunction verifyRegistration(data, callback) {\n    pool.getConnection(function (err, connection) {\n        if (err) {\n            connection.release();\n            throw err;\n        }\n        //super duper vulnerable to sql injection, but nobody say anything\n        let check = `SELECT SSN, voterName FROM VoterData WHERE SSN = ${data.ssn} AND voterName = '${data.name}';`\n        console.log(check)\n        connection.query(check, function (err, results) {\n            if (err) {\n                console.log(`Error in verifyRegistration select ssn and name query`)\n                return console.log(err.message)\n            }\n            let output = JSON.parse(JSON.stringify(results))\n            if(typeof(output[0]) === 'undefined' || !results){\n                console.log(`${data.name} has not registered to vote`)\n                return callback(0)\n            }\n            let name = output[0].voterName\n            let ssn = output[0].SSN\n            connection.release();\n            if (parseInt(data.ssn) === ssn && data.name === name) {\n                console.log(`${data.name} has registered to vote`)\n                return callback(1)\n            }\n            console.log(`${data.name} aka ${name} has not registered to vote with SSN = ${data.ssn} aka \\n SSN= ${ssn}`)\n            return callback(0)\n        })\n    })\n}\n// make all the files in 'public' available\n// https://expressjs.com/en/starter/static-files.html\napp.use(express.static(\"public\"));\n\n// https://expressjs.com/en/starter/basic-routing.html\napp.get(\"/\", (request, response) => {\n    response.sendFile(__dirname + \"/views/index.html\");\n});\n\napp.get(\"/ballot\", provideBallot);\n\nfunction provideBallot(request, response){\n    let cookies = request.headers.cookie\n    //currently just ensures that the cookie exists\n    if (typeof cookies !== 'undefined' && cookies) {\n        let ssn = getCookie('ssn', cookies)\n        let name = getCookie('name', cookies)\n        if (ssn !== '' && name !== '') {\n            verifyRegistration({ssn, name}, function (result) {\n                if (result === 1) {\n                    response.sendFile(__dirname + \"/views/ballot.html\");\n                }\n                else{\n                    response.sendStatus(401)\n                }\n            })\n        }\n    }else{\n        response.sendStatus(401)\n    }\n}\n//code adapted from https://www.w3schools.com/js/js_cookies.asp\nfunction getCookie(cname, decodedCookie) {\n    let name = cname + \"=\";\n    let ca = decodedCookie.split(';');\n    for(let i = 0; i <ca.length; i++) {\n        let c = ca[i];\n        while (c.charAt(0) === ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) === 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}\n//Call by putting resetDB in the write-in field\nfunction resetDatabase() {\n    pool.getConnection(function (err, connection) {\n        if (err) {\n            connection.release();\n            throw err;\n        }\n        let deleteRecords = `DELETE FROM Votes;`\n        connection.query(deleteRecords, function (err, results, fields) {\n            if (err) {\n                return console.log(err.message)\n            }\n        })\n        connection.release();\n    })\n}\n\n//Call by putting deleteDB in the write-in field\nfunction deleteDatabase() {\n    pool.getConnection(function (err, connection) {\n        if (err) {\n            connection.release();\n            throw err;\n        }\n        let deleteDB = `DROP TABLE Votes`\n        connection.query(deleteDB, function (err, results, fields) {\n            if (err)\n                return console.log(err.message)\n        })\n        let deleteData = `DROP TABLE VoterData`\n        connection.query(deleteData, function (err, results, fields) {\n            if (err)\n                return console.log(err.message)\n        })\n        connection.release();\n    })\n}\napp.post(\"/requestBallot\", bodyParser.json(), (req, res) => {\n    let ssn = req.body.ssn\n    let name = req.body.name\n    verifyRegistration({ssn, name}, function(result) {\n        if (result === 1) {\n            res.cookie('ssn', ssn)\n            res.cookie('name', name)\n            res.sendFile(__dirname + \"/views/index.html\");\n        }\n        else{\n            //doesn't redirect you if on a browser, but might be useful\n            return res.sendStatus(401)\n        }\n    })\n})\n\napp.post(\"/voteFcn\", bodyParser.json(), (req, res) => {\n    let ssn = req.body.ssn\n    let name = req.body.name\n    let vote = req.body.candidate\n\n    //Quick and dirty way to reset/delete the database on the fly. NOTE: REMOVE BEFORE DEPLOYMENT\n    if (vote === 'resetDB') {\n        resetDatabase()\n        res.json({res: false, message: `Reset database.`})\n        return console.log(`Reset database!`)\n    }\n    if (vote === 'deleteDB') {\n        deleteDatabase()\n        res.json({res: false, message: `Deleted database, please restart the server.`})\n        return console.log('Deleted database, please restart server.')\n    }\n    let value = 0\n    checkVoted({ssn, name, vote}, function (result) {\n        value = result\n        console.log(`VALUE checkVoted = ${value}`)\n        if (value === 1) {\n            res.json({res: false, message: `${name}, you have already voted.`})\n        } else {\n            addToDatabase({ssn, name, vote}, function (result) {\n                value = result\n                console.log(`VALUE addToDatabase = ${value}`)\n                if (result === 0) {\n                    res.json({res: false, message: `Error inserting new record into database.`})\n                } else if (result === 1) {\n                    res.json({res: true, message: `${name}, your vote for ${vote} has been recorded.`})\n                }\n            })\n        }\n    })\n\n})\n\nfunction checkVoted(data, callback) {\n    pool.getConnection(function (err, connection) {\n        if (err) {\n            connection.release();\n            throw err;\n        }\n        //--------------------------------------\n        let check = 'SELECT ssn, voterName FROM votes;'\n        connection.query(check, function (err, results) {\n            let ssnArray = []\n            if (err) {\n                console.log(`Error in addDatabase select ssn query`)\n                return console.log(err.message)\n            }\n            Object.keys(results).forEach(function (key) {\n                let row = results[key]\n                ssnArray.push(row.ssn.toString())\n            })\n            console.log(ssnArray)\n            console.log(`SSN FROM DATA = ${data.ssn}`)\n            console.log(ssnArray.includes(data.ssn))\n            if (ssnArray.includes(data.ssn)) {\n                connection.release()\n                console.log(`${data.name} has already voted`)\n                return callback(1)\n            }\n            connection.release();\n            return callback(0)\n        })\n    })\n}\n\nfunction addToDatabase(data, callback) {\n    pool.getConnection(function (err, connection) {\n        if (err) {\n            connection.release()\n            throw err;\n        }\n        let sql = `INSERT INTO Votes VALUES (${data.ssn}, '${data.name}','${data.vote}')`\n        connection.query(sql, function (err, results, fields) {\n            if (err) {\n                connection.release()\n                console.log(err.message)\n                return callback(0)\n            }\n            connection.release();\n            console.log(\"1 record inserted.\")\n            return callback(1)\n        })\n    })\n}\n\n\napp.get('/votes', (req, res) => {\n    pool.getConnection(function (err, connection) {\n        if (err) {\n            connection.release();\n            throw err;\n        }\n        let candidates = []\n        let votes = []\n        let sql = 'SELECT candidateName, COUNT(*) AS numVotes FROM VOTES GROUP BY candidateName;'\n        connection.query(sql, function (err, results) {\n            if (err) {\n                console.log(`Error in app.get query`)\n                return console.log(err.message)\n            }\n            connection.release();\n            Object.keys(results).forEach(function (key) {\n                let row = results[key]\n                candidates.push(row.candidateName)\n                votes.push(row.numVotes)\n            })\n            res.json({nameCandidate: candidates, numVotes: votes})\n        })\n    })\n})\n\n// listen for requests :)\n/*const listener = app.listen(process.env.PORT, () => {\n    console.log(\"Your app is listening on port \" + listener.address().port);\n});*/\n\nconst options = {\n    key: fs.readFileSync(\"./certificates/key.pem\"),\n    cert: fs.readFileSync(\"./certificates/cert.pem\")\n}\n\n//Listen on http\napp.listen(8000)\n//Listen on https. The domain is https://localhost:8080\nhttps.createServer(options, app).listen(8090)\nconsole.log(\"Your app is listening on port 8000 for HTTP connections. http://localhost:8000\")\nconsole.log(\"Your app is listening on port 8090 for HTTPS connections. https://localhost:8090\")
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- server.js	(revision a338a2e6489e0c9ef43763d54eaa91b7f3e6c87c)
+++ server.js	(date 1604437439809)
@@ -12,6 +12,7 @@
 const fs = require('fs')
 const cookieparser = require('cookie-parser')
 app.use(cookieparser())
+const crypto = require('crypto'), algorithm = 'aes-256-ctr', password = 'jkasdnfgoi';
 
 const pool = mysql.createPool({
     connectionLimit: 100, //this should fix the weird error event bug
@@ -64,6 +65,20 @@
     connection.release();
 });
 
+//Code adapted from https://lollyrock.com/posts/nodejs-encryption/
+function encrypt(text){
+    let cipher = crypto.createCipher(algorithm, password)
+    let crypted = cipher.update(text, 'utf8', 'hex')
+    crypted += cipher.final('hex')
+    return crypted
+}
+
+function decrypt(text){
+    let decipher = crypto.createDecipher(algorithm, password)
+    let dec = decipher.update(text, 'hex', 'utf8')
+    dec += decipher.final('utf8')
+    return dec
+}
 function verifyRegistration(data, callback) {
     pool.getConnection(function (err, connection) {
         if (err) {
@@ -72,7 +87,6 @@
         }
         //super duper vulnerable to sql injection, but nobody say anything
         let check = `SELECT SSN, voterName FROM VoterData WHERE SSN = ${data.ssn} AND voterName = '${data.name}';`
-        console.log(check)
         connection.query(check, function (err, results) {
             if (err) {
                 console.log(`Error in verifyRegistration select ssn and name query`)
@@ -118,28 +132,36 @@
                     response.sendFile(__dirname + "/views/ballot.html");
                 }
                 else{
-                    response.sendStatus(401)
+                    response.clearCookie("ssn")
+                    response.clearCookie("name")
+                    return response.sendStatus(401)
                 }
             })
-        }
+        }else response.sendStatus(401)
     }else{
         response.sendStatus(401)
     }
 }
+
 //code adapted from https://www.w3schools.com/js/js_cookies.asp
 function getCookie(cname, decodedCookie) {
     let name = cname + "=";
-    let ca = decodedCookie.split(';');
-    for(let i = 0; i <ca.length; i++) {
-        let c = ca[i];
-        while (c.charAt(0) === ' ') {
-            c = c.substring(1);
-        }
-        if (c.indexOf(name) === 0) {
-            return c.substring(name.length, c.length);
-        }
-    }
-    return "";
+    if (typeof decodedCookie !== 'undefined' && decodedCookie) {
+        let ca = decodedCookie.split(';');
+        for (let i = 0; i < ca.length; i++) {
+            let c = ca[i];
+            while (c.charAt(0) === ' ') {
+                c = c.substring(1);
+            }
+            if (c.indexOf(name) === 0) {
+                let output = c.substring(name.length, c.length)
+                return decrypt(output);
+            }
+        }
+    }else{
+        return "";
+    }
+
 }
 //Call by putting resetDB in the write-in field
 function resetDatabase() {
@@ -183,20 +205,27 @@
     let name = req.body.name
     verifyRegistration({ssn, name}, function(result) {
         if (result === 1) {
-            res.cookie('ssn', ssn)
-            res.cookie('name', name)
+            res.cookie('ssn', encrypt(ssn))
+            res.cookie('name', encrypt(name))
             res.sendFile(__dirname + "/views/index.html");
         }
         else{
-            //doesn't redirect you if on a browser, but might be useful
-            return res.sendStatus(401)
+            if(req.header.cookie !== 'undefined' && req.header.cookie){
+                res.clearCookie("ssn")
+                res.clearCookie("name")
+                return res.sendStatus(401)
+            }
+            else {
+                return res.sendStatus(401)
+            }
         }
     })
 })
 
 app.post("/voteFcn", bodyParser.json(), (req, res) => {
-    let ssn = req.body.ssn
-    let name = req.body.name
+    let cookies = req.headers.cookie
+    let ssn = getCookie('ssn', cookies)
+    let name = getCookie('name', cookies)
     let vote = req.body.candidate
 
     //Quick and dirty way to reset/delete the database on the fly. NOTE: REMOVE BEFORE DEPLOYMENT
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"BranchesTreeState\">\n    <expand>\n      <path>\n        <item name=\"ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"LOCAL_ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n      </path>\n      <path>\n        <item name=\"ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"REMOTE_ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n      </path>\n      <path>\n        <item name=\"ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"REMOTE_ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"GROUP_NODE:origin\" type=\"e8cecc67:BranchNodeDescriptor\" />\n      </path>\n    </expand>\n    <select>\n      <path>\n        <item name=\"ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"REMOTE_ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"GROUP_NODE:origin\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"BRANCH:origin/main\" type=\"e8cecc67:BranchNodeDescriptor\" />\n      </path>\n    </select>\n  </component>\n  <component name=\"ChangeListManager\">\n    <list default=\"true\" id=\"44f09017-54cf-4a63-81e4-f5a087895d71\" name=\"Default Changelist\" comment=\"Added session management and cookies\">\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/server.js\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/server.js\" afterDir=\"false\" />\n    </list>\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\n  </component>\n  <component name=\"FileTemplateManagerImpl\">\n    <option name=\"RECENT_TEMPLATES\">\n      <list>\n        <option value=\"HTML File\" />\n        <option value=\"JavaScript File\" />\n      </list>\n    </option>\n  </component>\n  <component name=\"Git.Settings\">\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\n  </component>\n  <component name=\"ProjectId\" id=\"1jKkPZ9MJCMBeORMnVqOGnETh9G\" />\n  <component name=\"ProjectViewState\">\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\n    <option name=\"showLibraryContents\" value=\"true\" />\n  </component>\n  <component name=\"PropertiesComponent\">\n    <property name=\"DefaultHtmlFileTemplate\" value=\"HTML File\" />\n    <property name=\"RunOnceActivity.OpenProjectViewOnStart\" value=\"true\" />\n    <property name=\"RunOnceActivity.ShowReadmeOnStart\" value=\"true\" />\n    <property name=\"WebServerToolWindowFactoryState\" value=\"false\" />\n    <property name=\"last_opened_file_path\" value=\"$PROJECT_DIR$\" />\n    <property name=\"nodejs_package_manager_path\" value=\"npm\" />\n    <property name=\"vue.rearranger.settings.migration\" value=\"true\" />\n  </component>\n  <component name=\"RunManager\" selected=\"npm.run\">\n    <configuration name=\"localhost:8000\" type=\"JavascriptDebugType\" temporary=\"true\" nameIsGenerated=\"true\" uri=\"http://localhost:8000\">\n      <method v=\"2\" />\n    </configuration>\n    <configuration default=\"true\" type=\"js.build_tools.npm\">\n      <package-json value=\"$PROJECT_DIR$/package.json\" />\n      <command value=\"run\" />\n      <scripts />\n      <node-interpreter value=\"project\" />\n      <envs />\n      <method v=\"2\" />\n    </configuration>\n    <configuration name=\"run\" type=\"js.build_tools.npm\" nameIsGenerated=\"true\">\n      <package-json value=\"$PROJECT_DIR$/package.json\" />\n      <command value=\"run\" />\n      <scripts>\n        <script value=\"start\" />\n      </scripts>\n      <node-interpreter value=\"project\" />\n      <envs />\n      <method v=\"2\">\n        <option name=\"NpmBeforeRunTask\" enabled=\"true\">\n          <package-json value=\"$PROJECT_DIR$/package.json\" />\n          <command value=\"install\" />\n          <node-interpreter value=\"project\" />\n          <envs />\n        </option>\n      </method>\n    </configuration>\n    <recent_temporary>\n      <list>\n        <item itemvalue=\"JavaScript Debug.localhost:8000\" />\n      </list>\n    </recent_temporary>\n  </component>\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\n  <component name=\"SvnConfiguration\">\n    <configuration />\n  </component>\n  <component name=\"TaskManager\">\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\n      <changelist id=\"44f09017-54cf-4a63-81e4-f5a087895d71\" name=\"Default Changelist\" comment=\"\" />\n      <created>1603560147168</created>\n      <option name=\"number\" value=\"Default\" />\n      <option name=\"presentableId\" value=\"Default\" />\n      <updated>1603560147168</updated>\n      <workItem from=\"1603560148475\" duration=\"5839000\" />\n      <workItem from=\"1603571061150\" duration=\"4982000\" />\n      <workItem from=\"1603578308556\" duration=\"490000\" />\n      <workItem from=\"1603584299298\" duration=\"2810000\" />\n      <workItem from=\"1603609682714\" duration=\"129000\" />\n      <workItem from=\"1603652357262\" duration=\"7076000\" />\n      <workItem from=\"1603724062077\" duration=\"2319000\" />\n      <workItem from=\"1603736098990\" duration=\"648000\" />\n      <workItem from=\"1603764398551\" duration=\"2956000\" />\n      <workItem from=\"1603811517209\" duration=\"460000\" />\n      <workItem from=\"1603812106810\" duration=\"1246000\" />\n      <workItem from=\"1603815430529\" duration=\"1945000\" />\n      <workItem from=\"1603819306234\" duration=\"874000\" />\n      <workItem from=\"1603820344732\" duration=\"46000\" />\n      <workItem from=\"1603821955898\" duration=\"1723000\" />\n      <workItem from=\"1603824012703\" duration=\"630000\" />\n      <workItem from=\"1603825082545\" duration=\"9679000\" />\n      <workItem from=\"1603928567074\" duration=\"8217000\" />\n      <workItem from=\"1603977121201\" duration=\"895000\" />\n    </task>\n    <task id=\"LOCAL-00001\" summary=\"First Commit\">\n      <created>1603561399922</created>\n      <option name=\"number\" value=\"00001\" />\n      <option name=\"presentableId\" value=\"LOCAL-00001\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1603561399922</updated>\n    </task>\n    <task id=\"LOCAL-00002\" summary=\"Added barebones HTML for testing and updated .js files with proper names.\">\n      <created>1603565426003</created>\n      <option name=\"number\" value=\"00002\" />\n      <option name=\"presentableId\" value=\"LOCAL-00002\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1603565426003</updated>\n    </task>\n    <task id=\"LOCAL-00003\" summary=\"JS works now more or less, also added some stuff in the README.\">\n      <created>1603575850642</created>\n      <option name=\"number\" value=\"00003\" />\n      <option name=\"presentableId\" value=\"LOCAL-00003\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1603575850642</updated>\n    </task>\n    <task id=\"LOCAL-00004\" summary=\"Added function that displays json from server side representing candidates and votes. TODO: Query from database and populate the arrays instead of using the predefined ones\">\n      <created>1603602822508</created>\n      <option name=\"number\" value=\"00004\" />\n      <option name=\"presentableId\" value=\"LOCAL-00004\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1603602822508</updated>\n    </task>\n    <task id=\"LOCAL-00005\" summary=\"Finished voting system&#10;Fixed bug causing the list of votes on webpage to not clear on page reload&#10;Database can be reset by entering resetDB into write-in field on page&#10;Database can be deleted by entering deleteDB into write-in field on page\">\n      <created>1603692009597</created>\n      <option name=\"number\" value=\"00005\" />\n      <option name=\"presentableId\" value=\"LOCAL-00005\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1603692009597</updated>\n    </task>\n    <task id=\"LOCAL-00006\" summary=\"Added line to reload page upon successful casting of vote to let voter see results\">\n      <created>1603692120210</created>\n      <option name=\"number\" value=\"00006\" />\n      <option name=\"presentableId\" value=\"LOCAL-00006\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1603692120210</updated>\n    </task>\n    <task id=\"LOCAL-00007\" summary=\"Added session management and cookies\">\n      <created>1603936762541</created>\n      <option name=\"number\" value=\"00007\" />\n      <option name=\"presentableId\" value=\"LOCAL-00007\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1603936762541</updated>\n    </task>\n    <option name=\"localTasksCounter\" value=\"8\" />\n    <servers />\n  </component>\n  <component name=\"TypeScriptGeneratedFilesManager\">\n    <option name=\"version\" value=\"3\" />\n  </component>\n  <component name=\"UnknownFeatures\">\n    <option featureType=\"com.intellij.fileTypeFactory\" implementationName=\"*.conf\" />\n  </component>\n  <component name=\"Vcs.Log.Tabs.Properties\">\n    <option name=\"TAB_STATES\">\n      <map>\n        <entry key=\"MAIN\">\n          <value>\n            <State>\n              <option name=\"FILTERS\">\n                <map>\n                  <entry key=\"branch\">\n                    <value>\n                      <list>\n                        <option value=\"origin/main\" />\n                      </list>\n                    </value>\n                  </entry>\n                </map>\n              </option>\n            </State>\n          </value>\n        </entry>\n      </map>\n    </option>\n    <option name=\"oldMeFiltersMigrated\" value=\"true\" />\n  </component>\n  <component name=\"VcsManagerConfiguration\">\n    <MESSAGE value=\"First Commit\" />\n    <MESSAGE value=\"Added barebones HTML for testing and updated .js files with proper names.\" />\n    <MESSAGE value=\"JS works now more or less, also added some  stuff in the README.\" />\n    <MESSAGE value=\"JS works now more or less, also added some stuff in the README.\" />\n    <MESSAGE value=\"Added function that displays json from server side representing candidates and votes. TODO: Query from database and populate the arrays instead of using the predefined ones\" />\n    <MESSAGE value=\"working on db\" />\n    <MESSAGE value=\"Finished voting system&#10;Fixed bug causing the list of votes on webpage to not clear on page reload&#10;Database can be reset by entering resetDB into write-in field on page&#10;Database can be deleted by entering deleteDB into write-in field on page\" />\n    <MESSAGE value=\"Added line to reload page upon successful casting of vote to let voter see results\" />\n    <MESSAGE value=\"Added session management and cookies\" />\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"Added session management and cookies\" />\n  </component>\n  <component name=\"WindowStateProjectService\">\n    <state x=\"601\" y=\"288\" width=\"467\" height=\"453\" key=\"#Web_Browsers\" timestamp=\"1603828145592\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state x=\"601\" y=\"288\" width=\"467\" height=\"453\" key=\"#Web_Browsers/0.27.1680.955@0.27.1680.955\" timestamp=\"1603828145592\" />\n    <state x=\"298\" y=\"162\" width=\"1084\" height=\"710\" key=\"#com.intellij.execution.impl.EditConfigurationsDialog\" timestamp=\"1603560512137\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state x=\"298\" y=\"162\" width=\"1084\" height=\"710\" key=\"#com.intellij.execution.impl.EditConfigurationsDialog/0.27.1680.955@0.27.1680.955\" timestamp=\"1603560512137\" />\n    <state x=\"655\" y=\"303\" width=\"524\" height=\"509\" key=\"#com.intellij.refactoring.safeDelete.UnsafeUsagesDialog\" timestamp=\"1603919732735\">\n      <screen x=\"0\" y=\"25\" width=\"1920\" height=\"1175\" />\n    </state>\n    <state x=\"655\" y=\"303\" key=\"#com.intellij.refactoring.safeDelete.UnsafeUsagesDialog/0.25.1920.1175@0.25.1920.1175\" timestamp=\"1603919732735\" />\n    <state x=\"573\" y=\"253\" width=\"524\" height=\"509\" key=\"#com.intellij.refactoring.safeDelete.UnsafeUsagesDialog/0.27.1680.955@0.27.1680.955\" timestamp=\"1603563419132\" />\n    <state x=\"2090\" y=\"114\" width=\"979\" height=\"811\" key=\"CommitChangelistDialog2\" timestamp=\"1603674182835\">\n      <screen x=\"1920\" y=\"0\" width=\"1920\" height=\"1040\" />\n    </state>\n    <state x=\"2090\" y=\"114\" width=\"979\" height=\"811\" key=\"CommitChangelistDialog2/0.0.1920.1040/1920.0.1920.1040@1920.0.1920.1040\" timestamp=\"1603674182835\" />\n    <state x=\"623\" y=\"262\" width=\"424\" height=\"491\" key=\"FileChooserDialogImpl\" timestamp=\"1603560167455\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state x=\"623\" y=\"262\" width=\"424\" height=\"491\" key=\"FileChooserDialogImpl/0.27.1680.955@0.27.1680.955\" timestamp=\"1603560167455\" />\n    <state width=\"1721\" height=\"288\" key=\"GridCell.Tab.0.bottom\" timestamp=\"1603936809734\">\n      <screen x=\"0\" y=\"25\" width=\"1920\" height=\"1175\" />\n    </state>\n    <state width=\"948\" height=\"2\" key=\"GridCell.Tab.0.bottom/0.0.1920.1040/1920.0.1920.1040@1920.0.1920.1040\" timestamp=\"1603670741507\" />\n    <state width=\"1721\" height=\"288\" key=\"GridCell.Tab.0.bottom/0.25.1920.1175@0.25.1920.1175\" timestamp=\"1603936809734\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.0.bottom/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834741184\" />\n    <state width=\"1721\" height=\"288\" key=\"GridCell.Tab.0.center\" timestamp=\"1603936809733\">\n      <screen x=\"0\" y=\"25\" width=\"1920\" height=\"1175\" />\n    </state>\n    <state width=\"948\" height=\"2\" key=\"GridCell.Tab.0.center/0.0.1920.1040/1920.0.1920.1040@1920.0.1920.1040\" timestamp=\"1603670741507\" />\n    <state width=\"1721\" height=\"288\" key=\"GridCell.Tab.0.center/0.25.1920.1175@0.25.1920.1175\" timestamp=\"1603936809733\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.0.center/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834741183\" />\n    <state width=\"1721\" height=\"288\" key=\"GridCell.Tab.0.left\" timestamp=\"1603936809733\">\n      <screen x=\"0\" y=\"25\" width=\"1920\" height=\"1175\" />\n    </state>\n    <state width=\"948\" height=\"2\" key=\"GridCell.Tab.0.left/0.0.1920.1040/1920.0.1920.1040@1920.0.1920.1040\" timestamp=\"1603670741507\" />\n    <state width=\"1721\" height=\"288\" key=\"GridCell.Tab.0.left/0.25.1920.1175@0.25.1920.1175\" timestamp=\"1603936809733\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.0.left/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834741183\" />\n    <state width=\"1721\" height=\"288\" key=\"GridCell.Tab.0.right\" timestamp=\"1603936809733\">\n      <screen x=\"0\" y=\"25\" width=\"1920\" height=\"1175\" />\n    </state>\n    <state width=\"948\" height=\"2\" key=\"GridCell.Tab.0.right/0.0.1920.1040/1920.0.1920.1040@1920.0.1920.1040\" timestamp=\"1603670741507\" />\n    <state width=\"1721\" height=\"288\" key=\"GridCell.Tab.0.right/0.25.1920.1175@0.25.1920.1175\" timestamp=\"1603936809733\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.0.right/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834741184\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.1.bottom\" timestamp=\"1603834742537\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.1.bottom/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834742537\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.1.center\" timestamp=\"1603834742536\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.1.center/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834742536\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.1.left\" timestamp=\"1603834742536\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.1.left/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834742536\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.1.right\" timestamp=\"1603834742536\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.1.right/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834742536\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.2.bottom\" timestamp=\"1603834741518\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.2.bottom/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834741518\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.2.center\" timestamp=\"1603834741517\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.2.center/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834741517\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.2.left\" timestamp=\"1603834741515\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.2.left/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834741515\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.2.right\" timestamp=\"1603834741518\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.2.right/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834741518\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.3.bottom\" timestamp=\"1603834661288\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.3.bottom/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834661288\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.3.center\" timestamp=\"1603834661287\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.3.center/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834661287\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.3.left\" timestamp=\"1603834661287\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.3.left/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834661287\" />\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.3.right\" timestamp=\"1603834661288\">\n      <screen x=\"0\" y=\"27\" width=\"1680\" height=\"955\" />\n    </state>\n    <state width=\"1657\" height=\"301\" key=\"GridCell.Tab.3.right/0.27.1680.955@0.27.1680.955\" timestamp=\"1603834661288\" />\n    <state x=\"799\" y=\"326\" width=\"313\" height=\"568\" key=\"RollbackChangesDialog\" timestamp=\"1603575729488\">\n      <screen x=\"0\" y=\"25\" width=\"1920\" height=\"1175\" />\n    </state>\n    <state x=\"799\" y=\"326\" width=\"313\" height=\"568\" key=\"RollbackChangesDialog/0.25.1920.1175@0.25.1920.1175\" timestamp=\"1603575729488\" />\n    <state x=\"497\" y=\"270\" width=\"802\" height=\"523\" key=\"Vcs.Push.Dialog.v2\" timestamp=\"1603936770482\">\n      <screen x=\"0\" y=\"25\" width=\"1920\" height=\"1175\" />\n    </state>\n    <state x=\"497\" y=\"270\" width=\"802\" height=\"523\" key=\"Vcs.Push.Dialog.v2/0.25.1920.1175@0.25.1920.1175\" timestamp=\"1603936770482\" />\n    <state x=\"435\" y=\"226\" width=\"800\" height=\"563\" key=\"Vcs.Push.Dialog.v2/0.27.1680.955@0.27.1680.955\" timestamp=\"1603692123024\" />\n    <state x=\"710\" y=\"507\" width=\"361\" height=\"163\" key=\"com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2\" timestamp=\"1603835086119\">\n      <screen x=\"0\" y=\"25\" width=\"1920\" height=\"1175\" />\n    </state>\n    <state x=\"710\" y=\"507\" width=\"361\" height=\"163\" key=\"com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2/0.25.1920.1175@0.25.1920.1175\" timestamp=\"1603835086119\" />\n    <state x=\"621\" y=\"419\" width=\"438\" height=\"177\" key=\"com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2/0.27.1680.955@0.27.1680.955\" timestamp=\"1603690955981\" />\n    <state x=\"2618\" y=\"311\" key=\"git4idea.merge.GitPullDialog\" timestamp=\"1603668256534\">\n      <screen x=\"1920\" y=\"0\" width=\"1920\" height=\"1040\" />\n    </state>\n    <state x=\"2618\" y=\"311\" key=\"git4idea.merge.GitPullDialog/0.0.1920.1040/1920.0.1920.1040@1920.0.1920.1040\" timestamp=\"1603668256534\" />\n    <state x=\"576\" y=\"271\" key=\"run.anything.popup\" timestamp=\"1603916346726\">\n      <screen x=\"0\" y=\"25\" width=\"1920\" height=\"1175\" />\n    </state>\n    <state x=\"576\" y=\"271\" key=\"run.anything.popup/0.25.1920.1175@0.25.1920.1175\" timestamp=\"1603916346726\" />\n    <state x=\"504\" y=\"227\" key=\"run.anything.popup/0.27.1680.955@0.27.1680.955\" timestamp=\"1603684718383\" />\n    <state x=\"575\" y=\"280\" width=\"768\" height=\"835\" key=\"search.everywhere.popup\" timestamp=\"1603977221765\">\n      <screen x=\"0\" y=\"25\" width=\"1920\" height=\"1175\" />\n    </state>\n    <state x=\"575\" y=\"280\" width=\"768\" height=\"835\" key=\"search.everywhere.popup/0.25.1920.1175@0.25.1920.1175\" timestamp=\"1603977221765\" />\n    <state x=\"503\" y=\"234\" width=\"672\" height=\"678\" key=\"search.everywhere.popup/0.27.1680.955@0.27.1680.955\" timestamp=\"1603677193543\" />\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/workspace.xml	(revision a338a2e6489e0c9ef43763d54eaa91b7f3e6c87c)
+++ .idea/workspace.xml	(date 1604437480966)
@@ -26,8 +26,9 @@
     </select>
   </component>
   <component name="ChangeListManager">
-    <list default="true" id="44f09017-54cf-4a63-81e4-f5a087895d71" name="Default Changelist" comment="Added session management and cookies">
+    <list default="true" id="44f09017-54cf-4a63-81e4-f5a087895d71" name="Default Changelist" comment="Added registration check when requesting a ballot">
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/public/ballot.js" beforeDir="false" afterPath="$PROJECT_DIR$/public/ballot.js" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/server.js" beforeDir="false" afterPath="$PROJECT_DIR$/server.js" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
@@ -56,7 +57,7 @@
     <property name="RunOnceActivity.OpenProjectViewOnStart" value="true" />
     <property name="RunOnceActivity.ShowReadmeOnStart" value="true" />
     <property name="WebServerToolWindowFactoryState" value="false" />
-    <property name="last_opened_file_path" value="$PROJECT_DIR$" />
+    <property name="last_opened_file_path" value="$PROJECT_DIR$/public/ballot.js" />
     <property name="nodejs_package_manager_path" value="npm" />
     <property name="vue.rearranger.settings.migration" value="true" />
   </component>
@@ -124,7 +125,8 @@
       <workItem from="1603824012703" duration="630000" />
       <workItem from="1603825082545" duration="9679000" />
       <workItem from="1603928567074" duration="8217000" />
-      <workItem from="1603977121201" duration="895000" />
+      <workItem from="1603977121201" duration="942000" />
+      <workItem from="1604433756574" duration="3717000" />
     </task>
     <task id="LOCAL-00001" summary="First Commit">
       <created>1603561399922</created>
@@ -175,7 +177,14 @@
       <option name="project" value="LOCAL" />
       <updated>1603936762541</updated>
     </task>
-    <option name="localTasksCounter" value="8" />
+    <task id="LOCAL-00008" summary="Added registration check when requesting a ballot">
+      <created>1603978052916</created>
+      <option name="number" value="00008" />
+      <option name="presentableId" value="LOCAL-00008" />
+      <option name="project" value="LOCAL" />
+      <updated>1603978052916</updated>
+    </task>
+    <option name="localTasksCounter" value="9" />
     <servers />
   </component>
   <component name="TypeScriptGeneratedFilesManager">
@@ -218,7 +227,8 @@
     <MESSAGE value="Finished voting system&#10;Fixed bug causing the list of votes on webpage to not clear on page reload&#10;Database can be reset by entering resetDB into write-in field on page&#10;Database can be deleted by entering deleteDB into write-in field on page" />
     <MESSAGE value="Added line to reload page upon successful casting of vote to let voter see results" />
     <MESSAGE value="Added session management and cookies" />
-    <option name="LAST_COMMIT_MESSAGE" value="Added session management and cookies" />
+    <MESSAGE value="Added registration check when requesting a ballot" />
+    <option name="LAST_COMMIT_MESSAGE" value="Added registration check when requesting a ballot" />
   </component>
   <component name="WindowStateProjectService">
     <state x="601" y="288" width="467" height="453" key="#Web_Browsers" timestamp="1603828145592">
@@ -238,9 +248,10 @@
       <screen x="1920" y="0" width="1920" height="1040" />
     </state>
     <state x="2090" y="114" width="979" height="811" key="CommitChangelistDialog2/0.0.1920.1040/1920.0.1920.1040@1920.0.1920.1040" timestamp="1603674182835" />
-    <state x="623" y="262" width="424" height="491" key="FileChooserDialogImpl" timestamp="1603560167455">
-      <screen x="0" y="27" width="1680" height="955" />
+    <state x="712" y="314" width="424" height="491" key="FileChooserDialogImpl" timestamp="1604434855867">
+      <screen x="0" y="25" width="1920" height="1175" />
     </state>
+    <state x="712" y="314" key="FileChooserDialogImpl/0.25.1920.1175@0.25.1920.1175" timestamp="1604434855867" />
     <state x="623" y="262" width="424" height="491" key="FileChooserDialogImpl/0.27.1680.955@0.27.1680.955" timestamp="1603560167455" />
     <state width="1721" height="288" key="GridCell.Tab.0.bottom" timestamp="1603936809734">
       <screen x="0" y="25" width="1920" height="1175" />
@@ -318,10 +329,10 @@
       <screen x="0" y="25" width="1920" height="1175" />
     </state>
     <state x="799" y="326" width="313" height="568" key="RollbackChangesDialog/0.25.1920.1175@0.25.1920.1175" timestamp="1603575729488" />
-    <state x="497" y="270" width="802" height="523" key="Vcs.Push.Dialog.v2" timestamp="1603936770482">
+    <state x="497" y="270" width="802" height="523" key="Vcs.Push.Dialog.v2" timestamp="1603978057526">
       <screen x="0" y="25" width="1920" height="1175" />
     </state>
-    <state x="497" y="270" width="802" height="523" key="Vcs.Push.Dialog.v2/0.25.1920.1175@0.25.1920.1175" timestamp="1603936770482" />
+    <state x="497" y="270" width="802" height="523" key="Vcs.Push.Dialog.v2/0.25.1920.1175@0.25.1920.1175" timestamp="1603978057526" />
     <state x="435" y="226" width="800" height="563" key="Vcs.Push.Dialog.v2/0.27.1680.955@0.27.1680.955" timestamp="1603692123024" />
     <state x="710" y="507" width="361" height="163" key="com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2" timestamp="1603835086119">
       <screen x="0" y="25" width="1920" height="1175" />
@@ -337,10 +348,10 @@
     </state>
     <state x="576" y="271" key="run.anything.popup/0.25.1920.1175@0.25.1920.1175" timestamp="1603916346726" />
     <state x="504" y="227" key="run.anything.popup/0.27.1680.955@0.27.1680.955" timestamp="1603684718383" />
-    <state x="575" y="280" width="768" height="835" key="search.everywhere.popup" timestamp="1603977221765">
+    <state x="575" y="280" width="768" height="835" key="search.everywhere.popup" timestamp="1604435547104">
       <screen x="0" y="25" width="1920" height="1175" />
     </state>
-    <state x="575" y="280" width="768" height="835" key="search.everywhere.popup/0.25.1920.1175@0.25.1920.1175" timestamp="1603977221765" />
+    <state x="575" y="280" width="768" height="835" key="search.everywhere.popup/0.25.1920.1175@0.25.1920.1175" timestamp="1604435547104" />
     <state x="503" y="234" width="672" height="678" key="search.everywhere.popup/0.27.1680.955@0.27.1680.955" timestamp="1603677193543" />
   </component>
 </project>
\ No newline at end of file
Index: public/ballot.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>const votesList = document.getElementById(\"votes\")\nconst votesForm = document.querySelector(\"form\")\n\n\nfunction addNewVote(candidate, voteNum) {\n    const newListItem = document.createElement(\"li\")\n    newListItem.innerText = candidate + '\\t' + voteNum\n    votesList.appendChild(newListItem)\n}\n\nfetch(\"/votes\")\n    .then(res => res.json())\n    .then(vvvvvvv => {\n        let candidates = vvvvvvv.nameCandidate\n        let votes = vvvvvvv.numVotes\n        //remove loading message\n        //votesList.firstElementChild.remove()\n        votesList.innerHTML=''\n        //iterate through every new vote and add it to the page\n        for (let i = 0; i < candidates.length; i++) {\n            addNewVote(candidates[i], votes[i])\n        }\n    })\n\n//Listen for the form to be submitted and add the vote\nvotesForm.addEventListener(\"submit\", event => {\n    console.log(\"Is god there?\")\n    //Stop form from refreshing the page\n    event.preventDefault()\n\n    let ssNumber = getCookie(\"ssn\", document.cookie)\n    let voterName = getCookie(\"name\", document.cookie)\n    let vote = votesForm.elements.vote.value\n    if (vote === 'writein') vote = votesForm.elements.writein.value\n    //Check for valid input before sending to server\n    if (!/^[a-zA-Z0-9][a-zA-Z0-9\\s-]*$/.test(voterName)) {//parse inputs\n        alert(\"Invalid input. Name can only contain A-Z, a-z, 0-9, and spaces/hyphens.\")\n        return;\n    }\n    if (!/^[a-zA-Z0-9][a-zA-Z0-9\\s-]*$/.test(vote)) {\n        alert(`Invalid input \"${vote}\". Write-In can only contain A-Z, a-z, 0-9, and spaces/hyphens.`)\n        return;\n    }\n    if (!/^([0-9])*$/.test(ssNumber) || ssNumber === '' || !(ssNumber.length !== '9')) {\n        alert(`Invalid input for SSN \"${ssNumber}\" with length \"${ssNumber.length}\". Enter nine digits with no spaces or symbols.`)\n    }\n    //Input can now be sent to server\n    return fetch(\"/voteFcn\", {\n        method: \"POST\",\n        body: JSON.stringify({ssn: ssNumber, name: voterName, candidate: vote}),\n        headers: {\"Content-Type\": \"application/json\"}\n    })\n        .then(res => res.json())\n        .then(json => {\n            if(json.res ===true) {\n                alert(json.message)\n                location.reload()\n            }\n            else if(json.res===false){\n                alert(json.message)\n                location.reload()\n            }\n            //reset form\n            votesForm.reset()\n        })\n})\n\n//code adapted from https://www.w3schools.com/js/js_cookies.asp\nfunction getCookie(cname, decodedCookie) {\n    let name = cname + \"=\";\n    let ca = decodedCookie.split(';');\n    for(let i = 0; i <ca.length; i++) {\n        let c = ca[i];\n        while (c.charAt(0) === ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) === 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- public/ballot.js	(revision a338a2e6489e0c9ef43763d54eaa91b7f3e6c87c)
+++ public/ballot.js	(date 1604435604863)
@@ -24,7 +24,7 @@
 
 //Listen for the form to be submitted and add the vote
 votesForm.addEventListener("submit", event => {
-    console.log("Is god there?")
+
     //Stop form from refreshing the page
     event.preventDefault()
 
@@ -32,18 +32,12 @@
     let voterName = getCookie("name", document.cookie)
     let vote = votesForm.elements.vote.value
     if (vote === 'writein') vote = votesForm.elements.writein.value
-    //Check for valid input before sending to server
-    if (!/^[a-zA-Z0-9][a-zA-Z0-9\s-]*$/.test(voterName)) {//parse inputs
-        alert("Invalid input. Name can only contain A-Z, a-z, 0-9, and spaces/hyphens.")
-        return;
-    }
+
     if (!/^[a-zA-Z0-9][a-zA-Z0-9\s-]*$/.test(vote)) {
         alert(`Invalid input "${vote}". Write-In can only contain A-Z, a-z, 0-9, and spaces/hyphens.`)
         return;
     }
-    if (!/^([0-9])*$/.test(ssNumber) || ssNumber === '' || !(ssNumber.length !== '9')) {
-        alert(`Invalid input for SSN "${ssNumber}" with length "${ssNumber.length}". Enter nine digits with no spaces or symbols.`)
-    }
+
     //Input can now be sent to server
     return fetch("/voteFcn", {
         method: "POST",
